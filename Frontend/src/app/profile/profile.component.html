<section class="profile-container">
  <div *ngIf="user" class="profile-card">
    <img
      *ngIf="user.imageUrl; else noImage"
      [src]="user.imageUrl"
      alt="Profile Image"
      class="profile-image"
    />
    <ng-template #noImage>No profile image available</ng-template>
    <h2>Profile</h2>
    <p><strong>First Name:</strong> {{ user.first_name }}</p>
    <p><strong>Last Name:</strong> {{ user.last_name }}</p>
    <p><strong>Username:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>Role:</strong> {{ user.roleName }}</p>

    <button (click)="uploadImage()">Add/Update Profile Image</button>
    <button (click)="editProfile()">Edit Profile</button>
    <button (click)="confirmDelete()">Delete Account</button>
    <button (click)="requestRoleChange()">Request Role Change</button>
    <button (click)="requestPasswordReset()">Request Password Reset</button>
  </div>

  <!-- Admin Panel: Role Change Requests -->
  <div *ngIf="user.role === 3" class="admin-requests">
    <h2>Role Change Requests</h2>
    <table>
      <thead>
        <tr>
          <th>User UUID</th>
          <th>Requested Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of roleChangeRequests">
          <td>{{ request.user_uuid }}</td>
          <td>{{ getRoleName(request.requested_role) }}</td>
          <td>{{ request.status }}</td>
          <td>
            <button (click)="reviewRequest(request.uuid, 'approved')">Approve</button>
            <button (click)="reviewRequest(request.uuid, 'rejected')">Reject</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<!-- Popup za potvrdu brisanja -->
<div class="popup-overlay" *ngIf="showDeleteConfirmation">
  <div class="popup">
    <p>Are you sure you want to delete your account? This action cannot be undone.</p>
    <button (click)="deleteAccount()">Yes, Delete</button>
    <button (click)="showDeleteConfirmation = false">Cancel</button>
  </div>
</div>
